<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Outlook AI Pro - å°ˆæ¥­éƒµä»¶ç®¡ç†ç³»çµ±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f3f2f1;
            height: 100vh;
            overflow: hidden;
        }

        /* é ‚éƒ¨å·¥å…·åˆ— */
        .ribbon {
            background: #0078d4;
            color: white;
            padding: 12px 20px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .ribbon h1 {
            font-size: 18px;
            font-weight: 600;
            flex: 1;
        }

        .ribbon-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .ribbon-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .ribbon-btn.primary {
            background: #106ebe;
        }

        .ribbon-btn.primary:hover {
            background: #005a9e;
        }

        /* æœå°‹æ¡† */
        .search-box {
            flex: 0 0 300px;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 8px 35px 8px 12px;
            border: none;
            border-radius: 4px;
            font-size: 14px;
        }

        .search-box::after {
            content: 'ğŸ”';
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
        }

        /* ä¸»è¦å…§å®¹å€ */
        .main-container {
            display: flex;
            height: calc(100vh - 48px);
            background: white;
        }

        /* å·¦å´ï¼šè³‡æ–™å¤¾çª—æ ¼ */
        .folder-pane {
            width: 220px;
            background: #faf9f8;
            border-right: 1px solid #edebe9;
            overflow-y: auto;
            padding: 10px 0;
        }

        .folder-section {
            margin-bottom: 20px;
        }

        .folder-section-title {
            font-size: 11px;
            font-weight: 600;
            color: #605e5c;
            padding: 8px 16px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .folder-item {
            padding: 8px 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            color: #323130;
            font-size: 14px;
            transition: all 0.2s;
        }

        .folder-item:hover {
            background: #f3f2f1;
        }

        .folder-item.active {
            background: #e1dfdd;
            font-weight: 600;
            border-left: 3px solid #0078d4;
        }

        .folder-item .count {
            margin-left: auto;
            background: #0078d4;
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 11px;
            font-weight: 600;
        }

        /* ä¸­é–“ï¼šéƒµä»¶åˆ—è¡¨ */
        .email-list-pane {
            width: 380px;
            border-right: 1px solid #edebe9;
            display: flex;
            flex-direction: column;
        }

        .email-list-header {
            padding: 16px;
            border-bottom: 1px solid #edebe9;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .email-list-header h2 {
            font-size: 20px;
            color: #323130;
        }

        .view-controls {
            display: flex;
            gap: 8px;
        }

        .view-btn {
            background: none;
            border: 1px solid #edebe9;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            color: #605e5c;
        }

        .view-btn:hover {
            background: #f3f2f1;
        }

        .email-list {
            flex: 1;
            overflow-y: auto;
        }

        .email-item {
            padding: 16px;
            border-bottom: 1px solid #f3f2f1;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .email-item:hover {
            background: #faf9f8;
        }

        .email-item.selected {
            background: #e1dfdd;
            border-left: 3px solid #0078d4;
        }

        .email-item.unread {
            background: #f3f9fd;
            font-weight: 600;
        }

        .email-item.unread::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 4px;
            background: #0078d4;
            border-radius: 50%;
        }

        .email-sender {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
        }

        .sender-name {
            font-size: 14px;
            color: #323130;
        }

        .email-time {
            font-size: 12px;
            color: #605e5c;
        }

        .email-subject {
            font-size: 13px;
            color: #323130;
            margin-bottom: 4px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .email-preview {
            font-size: 12px;
            color: #605e5c;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .email-tags {
            display: flex;
            gap: 6px;
            margin-top: 6px;
        }

        .tag {
            font-size: 10px;
            padding: 2px 8px;
            border-radius: 10px;
            font-weight: 600;
        }

        .tag-urgent { background: #fde7e9; color: #a4262c; }
        .tag-important { background: #fff4ce; color: #8a5100; }
        .tag-opportunity { background: #dff6dd; color: #0b6a0b; }

        /* å³å´ï¼šé–±è®€çª—æ ¼ */
        .reading-pane {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .reading-header {
            padding: 20px 24px;
            border-bottom: 1px solid #edebe9;
        }

        .reading-subject {
            font-size: 24px;
            color: #323130;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .reading-meta {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-bottom: 12px;
        }

        .sender-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #0078d4;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 16px;
        }

        .sender-info {
            flex: 1;
        }

        .sender-info-name {
            font-size: 14px;
            font-weight: 600;
            color: #323130;
        }

        .sender-info-email {
            font-size: 12px;
            color: #605e5c;
        }

        .action-buttons {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }

        .action-btn {
            background: white;
            border: 1px solid #8a8886;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 13px;
            color: #323130;
            transition: all 0.2s;
        }

        .action-btn:hover {
            background: #f3f2f1;
        }

        .action-btn.primary {
            background: #0078d4;
            border-color: #0078d4;
            color: white;
        }

        .action-btn.primary:hover {
            background: #106ebe;
        }

        .reading-content {
            flex: 1;
            overflow-y: auto;
            display: flex;
            gap: 20px;
            padding: 24px;
        }

        .email-body {
            flex: 1;
            font-size: 14px;
            line-height: 1.6;
            color: #323130;
        }

        /* AI åˆ†æé¢æ¿ */
        .ai-insights {
            width: 320px;
            background: #faf9f8;
            border-radius: 8px;
            padding: 20px;
            height: fit-content;
        }

        .ai-insights h3 {
            font-size: 16px;
            color: #323130;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .insight-card {
            background: white;
            border: 1px solid #edebe9;
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 12px;
        }

        .insight-card h4 {
            font-size: 13px;
            color: #605e5c;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .insight-value {
            font-size: 18px;
            color: #0078d4;
            font-weight: 600;
        }

        .insight-list {
            list-style: none;
        }

        .insight-list li {
            padding: 6px 0;
            font-size: 13px;
            color: #323130;
            border-bottom: 1px solid #f3f2f1;
        }

        .insight-list li:last-child {
            border-bottom: none;
        }

        .todo-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            background: white;
            border: 1px solid #edebe9;
            border-radius: 4px;
            margin-bottom: 8px;
            cursor: pointer;
        }

        .todo-item:hover {
            background: #f3f2f1;
        }

        .todo-item input[type="checkbox"] {
            width: 16px;
            height: 16px;
        }

        .todo-item.done {
            opacity: 0.6;
            text-decoration: line-through;
        }

        /* ç©ºç‹€æ…‹ */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #605e5c;
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 16px;
        }

        .empty-state-text {
            font-size: 16px;
        }

        /* æ»¾å‹•æ¢æ¨£å¼ */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f3f2f1;
        }

        ::-webkit-scrollbar-thumb {
            background: #c8c6c4;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #a19f9d;
        }

        /* æ’°å¯«éƒµä»¶å½ˆçª— */
        .compose-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.4);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .compose-modal.active {
            display: flex;
        }

        .compose-window {
            background: white;
            width: 90%;
            max-width: 900px;
            height: 80vh;
            border-radius: 8px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
            display: flex;
            flex-direction: column;
        }

        .compose-header {
            padding: 16px 24px;
            border-bottom: 1px solid #edebe9;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #faf9f8;
        }

        .compose-header h2 {
            font-size: 16px;
            color: #323130;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            color: #605e5c;
            cursor: pointer;
            width: 32px;
            height: 32px;
            border-radius: 4px;
        }

        .close-btn:hover {
            background: #f3f2f1;
        }

        .compose-body {
            flex: 1;
            padding: 24px;
            overflow-y: auto;
        }

        .compose-field {
            margin-bottom: 16px;
        }

        .compose-field label {
            display: block;
            font-size: 13px;
            color: #605e5c;
            margin-bottom: 6px;
            font-weight: 600;
        }

        .compose-field input,
        .compose-field textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #edebe9;
            border-radius: 4px;
            font-size: 14px;
            font-family: inherit;
        }

        .compose-field input:focus,
        .compose-field textarea:focus {
            outline: none;
            border-color: #0078d4;
        }

        .compose-field textarea {
            min-height: 300px;
            resize: vertical;
        }

        .compose-footer {
            padding: 16px 24px;
            border-top: 1px solid #edebe9;
            display: flex;
            justify-content: space-between;
        }
    </style>
</head>
<body>
    <!-- é ‚éƒ¨å·¥å…·åˆ— -->
    <div class="ribbon">
        <h1>ğŸ“§ Outlook AI Pro</h1>
        <button class="ribbon-btn primary" onclick="composeEmail()">âœ‰ï¸ æ–°å¢éƒµä»¶</button>
        <button class="ribbon-btn" onclick="replyCurrentEmail()">â†©ï¸ å›è¦†</button>
        <button class="ribbon-btn" onclick="forwardCurrentEmail()">â¡ï¸ è½‰ç™¼</button>
        <button class="ribbon-btn" onclick="deleteCurrentEmail()">ğŸ—‘ï¸ åˆªé™¤</button>
        <div class="search-box">
            <input type="text" placeholder="æœå°‹éƒµä»¶..." oninput="searchEmails(this.value)">
        </div>
    </div>

    <!-- ä¸»è¦å…§å®¹å€ -->
    <div class="main-container">
        <!-- å·¦å´ï¼šè³‡æ–™å¤¾ -->
        <div class="folder-pane">
            <div class="folder-section">
                <div class="folder-section-title">æˆ‘çš„æœ€æ„›</div>
                <div class="folder-item active" onclick="selectFolder('inbox')">
                    ğŸ“¥ æ”¶ä»¶åŒ£
                    <span class="count" id="inboxCount">0</span>
                </div>
            </div>

            <div class="folder-section">
                <div class="folder-section-title">è³‡æ–™å¤¾</div>
                <div class="folder-item" onclick="selectFolder('inbox')">
                    ğŸ“¥ æ”¶ä»¶åŒ£
                    <span class="count" id="inboxCount2">0</span>
                </div>
                <div class="folder-item" onclick="selectFolder('sent')">
                    ğŸ“¤ å·²ç™¼é€çš„éƒµä»¶
                </div>
                <div class="folder-item" onclick="selectFolder('drafts')">
                    ğŸ“ è‰ç¨¿
                </div>
                <div class="folder-item" onclick="selectFolder('trash')">
                    ğŸ—‘ï¸ åƒåœ¾æ¡¶
                </div>
            </div>

            <div class="folder-section">
                <div class="folder-section-title">AI æ™ºèƒ½åˆ†é¡</div>
                <div class="folder-item" onclick="filterByPriority('urgent')">
                    ğŸ”´ ç·Šæ€¥è™•ç†
                    <span class="count">5</span>
                </div>
                <div class="folder-item" onclick="filterByPriority('important')">
                    â­ é‡è¦å•†æ©Ÿ
                    <span class="count">12</span>
                </div>
                <div class="folder-item" onclick="filterByPriority('pending')">
                    â³ å¾…å›è¦†
                    <span class="count">23</span>
                </div>
            </div>
        </div>

        <!-- ä¸­é–“ï¼šéƒµä»¶åˆ—è¡¨ -->
        <div class="email-list-pane">
            <div class="email-list-header">
                <h2>æ”¶ä»¶åŒ£</h2>
                <div class="view-controls">
                    <button class="view-btn">ğŸ“… æ—¥æœŸ</button>
                    <button class="view-btn">ğŸ‘¤ å¯„ä»¶äºº</button>
                </div>
            </div>
            <div class="email-list" id="emailList">
                <!-- éƒµä»¶é …ç›®æœƒå‹•æ…‹ç”Ÿæˆ -->
            </div>
        </div>

        <!-- å³å´ï¼šé–±è®€çª—æ ¼ -->
        <div class="reading-pane" id="readingPane">
            <div class="empty-state">
                <div class="empty-state-icon">ğŸ“¬</div>
                <div class="empty-state-text">é¸æ“‡ä¸€å°éƒµä»¶ä»¥é–±è®€</div>
            </div>
        </div>
    </div>

    <!-- æ’°å¯«éƒµä»¶å½ˆçª— -->
    <div class="compose-modal" id="composeModal">
        <div class="compose-window">
            <div class="compose-header">
                <h2>æ–°å¢éƒµä»¶</h2>
                <button class="close-btn" onclick="closeCompose()">&times;</button>
            </div>
            <div class="compose-body">
                <div class="compose-field">
                    <label>æ”¶ä»¶äºº</label>
                    <input type="email" id="composeTo" placeholder="example@email.com">
                </div>
                <div class="compose-field">
                    <label>å‰¯æœ¬ (CC)</label>
                    <input type="email" id="composeCc" placeholder="å¯é¸">
                </div>
                <div class="compose-field">
                    <label>ä¸»æ—¨</label>
                    <input type="text" id="composeSubject" placeholder="éƒµä»¶ä¸»æ—¨">
                </div>
                <div class="compose-field">
                    <label>å…§å®¹</label>
                    <textarea id="composeBody" placeholder="è¼¸å…¥éƒµä»¶å…§å®¹..."></textarea>
                </div>
            </div>
            <div class="compose-footer">
                <button class="action-btn primary" onclick="sendEmail()">ç™¼é€</button>
                <button class="action-btn" onclick="closeCompose()">å–æ¶ˆ</button>
            </div>
        </div>
    </div>

    <script>
        // ===== æ¨¡æ“¬ 200 å°éƒµä»¶è³‡æ–™ =====
        const emailsData = [];
        const senders = [
            { name: "ç‹å°æ˜", company: "ABC ç§‘æŠ€", avatar: "ç‹", color: "#0078d4", email: "wang@abc.com" },
            { name: "æç¾ç²", company: "XYZ è²¿æ˜“", avatar: "æ", color: "#d13438", email: "li@xyz.com" },
            { name: "é™³é›…å©·", company: "GHI é›†åœ˜", avatar: "é™³", color: "#107c10", email: "chen@ghi.com" },
            { name: "å¼µå»ºåœ‹", company: "DEF ä¼æ¥­", avatar: "å¼µ", color: "#5c2d91", email: "zhang@def.com" },
            { name: "åŠ‰ç¶“ç†", company: "JKL Trading", avatar: "åŠ‰", color: "#ff8c00", email: "liu@jkl.com" },
            { name: "é»ƒå¿—æ˜", company: "MNO å…¬å¸", avatar: "é»ƒ", color: "#008272", email: "huang@mno.com" },
            { name: "æ—æ·‘èŠ¬", company: "PQR ä¼æ¥­", avatar: "æ—", color: "#e3008c", email: "lin@pqr.com" },
            { name: "å³å¤§åŒ", company: "STU é›†åœ˜", avatar: "å³", color: "#00b7c3", email: "wu@stu.com" }
        ];

        const subjects = [
            "é—œæ–¼ç”¢å“å ±åƒ¹çš„è¨è«–",
            "Re: æŠ€è¡“è¦æ ¼ç¢ºèª",
            "ç‰©æµé…é€æ™‚é–“ç¢ºèª",
            "è¨‚å–®é€²åº¦æ›´æ–°",
            "æ–°ç”¢å“åˆä½œæ©Ÿæœƒ",
            "æœƒè­°é‚€è«‹ï¼šå°ˆæ¡ˆè¨è«–",
            "Re: å ±åƒ¹å–®ç¢ºèª",
            "å®¢æˆ¶éœ€æ±‚åˆ†æå ±å‘Š",
            "ä¸‹é€±æœƒè­°æ™‚é–“å®‰æ’",
            "ç”¢å“å±•ç¤ºé‚€è«‹"
        ];

        const priorities = ['normal', 'important', 'urgent'];
        const tags = [
            { type: 'urgent', label: 'ç·Šæ€¥' },
            { type: 'important', label: 'é‡è¦å•†æ©Ÿ' },
            { type: 'opportunity', label: 'å•†æ©Ÿ' }
        ];

        // ç”Ÿæˆ 200 å°éƒµä»¶
        for (let i = 0; i < 200; i++) {
            const sender = senders[Math.floor(Math.random() * senders.length)];
            const subject = subjects[Math.floor(Math.random() * subjects.length)];
            const priority = priorities[Math.floor(Math.random() * priorities.length)];
            const daysAgo = Math.floor(Math.random() * 30);
            const date = new Date();
            date.setDate(date.getDate() - daysAgo);

            emailsData.push({
                id: i + 1,
                sender: sender,
                subject: subject,
                preview: `é€™æ˜¯é—œæ–¼ ${subject} çš„éƒµä»¶é è¦½å…§å®¹...`,
                body: `è¦ªæ„›çš„æ”¶ä»¶äººï¼Œ\n\n${subject}\n\næˆ‘å€‘æƒ³èˆ‡æ‚¨è¨è«–ç›¸é—œäº‹å®œã€‚è«‹æŸ¥çœ‹é™„ä»¶äº†è§£æ›´å¤šè©³æƒ…ã€‚\n\næœŸå¾…æ‚¨çš„å›è¦†ã€‚\n\næ­¤è‡´\n${sender.name}\n${sender.company}`,
                date: date,
                unread: Math.random() > 0.7,
                priority: priority,
                tags: priority === 'urgent' ? [tags[0]] : priority === 'important' ? [tags[1]] : [],
                aiInsights: {
                    opportunityValue: priority === 'urgent' ? '$100K+' : priority === 'important' ? '$50K' : '$10K',
                    sentiment: priority === 'urgent' ? 'ç·Šæ€¥' : 'æ­£å¸¸',
                    actionItems: [
                        'æº–å‚™å ±åƒ¹å–®',
                        'ç¢ºèªæŠ€è¡“è¦æ ¼',
                        'å®‰æ’æœƒè­°æ™‚é–“'
                    ],
                    suggestedReply: 'æ„Ÿè¬æ‚¨çš„ä¾†ä¿¡ï¼Œæˆ‘å€‘æœƒç›¡å¿«è™•ç†æ‚¨çš„éœ€æ±‚ã€‚'
                }
            });
        }

        let currentFolder = 'inbox';
        let filteredEmails = [...emailsData];
        let selectedEmail = null;

        // ===== åˆå§‹åŒ– =====
        function init() {
            renderEmailList();
            updateCounts();
        }

        // ===== æ¸²æŸ“éƒµä»¶åˆ—è¡¨ =====
        function renderEmailList() {
            const listDiv = document.getElementById('emailList');
            listDiv.innerHTML = '';

            filteredEmails.forEach(email => {
                const item = document.createElement('div');
                item.className = 'email-item' + (email.unread ? ' unread' : '');
                if (selectedEmail && selectedEmail.id === email.id) {
                    item.classList.add('selected');
                }

                const timeStr = formatTime(email.date);
                const tagsHTML = email.tags.map(tag =>
                    `<span class="tag tag-${tag.type}">${tag.label}</span>`
                ).join('');

                item.innerHTML = `
                    <div class="email-sender">
                        <span class="sender-name">${email.sender.name}</span>
                        <span class="email-time">${timeStr}</span>
                    </div>
                    <div class="email-subject">${email.subject}</div>
                    <div class="email-preview">${email.preview}</div>
                    ${tagsHTML ? `<div class="email-tags">${tagsHTML}</div>` : ''}
                `;

                item.onclick = () => selectEmail(email);
                listDiv.appendChild(item);
            });
        }

        // ===== é¸æ“‡éƒµä»¶ =====
        function selectEmail(email) {
            selectedEmail = email;
            email.unread = false;
            renderEmailList();
            renderEmailContent(email);
            updateCounts();
        }

        // ===== æ¸²æŸ“éƒµä»¶å…§å®¹ =====
        function renderEmailContent(email) {
            const pane = document.getElementById('readingPane');

            pane.innerHTML = `
                <div class="reading-header">
                    <div class="reading-subject">${email.subject}</div>
                    <div class="reading-meta">
                        <div class="sender-avatar" style="background: ${email.sender.color}">
                            ${email.sender.avatar}
                        </div>
                        <div class="sender-info">
                            <div class="sender-info-name">${email.sender.name}</div>
                            <div class="sender-info-email">${email.sender.email}</div>
                        </div>
                        <div style="margin-left: auto; color: #605e5c; font-size: 13px;">
                            ${email.date.toLocaleString('zh-TW')}
                        </div>
                    </div>
                    <div class="action-buttons">
                        <button class="action-btn primary" onclick="replyCurrentEmail()">â†©ï¸ å›è¦†</button>
                        <button class="action-btn" onclick="replyAllCurrentEmail()">â†©ï¸ å…¨éƒ¨å›è¦†</button>
                        <button class="action-btn" onclick="forwardCurrentEmail()">â¡ï¸ è½‰ç™¼</button>
                        <button class="action-btn" onclick="deleteCurrentEmail()">ğŸ—‘ï¸ åˆªé™¤</button>
                    </div>
                </div>
                <div class="reading-content">
                    <div class="email-body">
                        ${email.body.replace(/\n/g, '<br>')}
                    </div>
                    <div class="ai-insights">
                        <h3>ğŸ¤– AI æ™ºèƒ½åˆ†æ</h3>

                        <div class="insight-card">
                            <h4>ğŸ’° å•†æ©Ÿåƒ¹å€¼</h4>
                            <div class="insight-value">${email.aiInsights.opportunityValue}</div>
                        </div>

                        <div class="insight-card">
                            <h4>ğŸ“Š æƒ…ç·’åˆ†æ</h4>
                            <div style="font-size: 14px; color: #323130;">${email.aiInsights.sentiment}</div>
                        </div>

                        <div class="insight-card">
                            <h4>âœ… å¾…è¾¦äº‹é …</h4>
                            ${email.aiInsights.actionItems.map((item, idx) => `
                                <div class="todo-item" onclick="toggleTodo(this)">
                                    <input type="checkbox">
                                    <span>${item}</span>
                                </div>
                            `).join('')}
                        </div>

                        <div class="insight-card">
                            <h4>ğŸ’¡ AI å»ºè­°å›è¦†</h4>
                            <div style="font-size: 13px; color: #605e5c; line-height: 1.5;">
                                ${email.aiInsights.suggestedReply}
                            </div>
                            <button class="action-btn" style="margin-top: 12px; width: 100%;"
                                    onclick="useSuggestedReply()">
                                ä½¿ç”¨æ­¤å›è¦†
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // ===== å·¥å…·å‡½æ•¸ =====
        function formatTime(date) {
            const now = new Date();
            const diff = now - date;
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));

            if (days === 0) {
                return date.toLocaleTimeString('zh-TW', { hour: '2-digit', minute: '2-digit' });
            } else if (days === 1) {
                return 'æ˜¨å¤©';
            } else if (days < 7) {
                return `${days} å¤©å‰`;
            } else {
                return date.toLocaleDateString('zh-TW', { month: 'short', day: 'numeric' });
            }
        }

        function updateCounts() {
            const unreadCount = emailsData.filter(e => e.unread).length;
            document.getElementById('inboxCount').textContent = unreadCount;
            document.getElementById('inboxCount2').textContent = unreadCount;
        }

        // ===== è³‡æ–™å¤¾åˆ‡æ› =====
        function selectFolder(folder) {
            currentFolder = folder;
            // æ›´æ–° active ç‹€æ…‹
            document.querySelectorAll('.folder-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        // ===== ç¯©é¸åŠŸèƒ½ =====
        function filterByPriority(priority) {
            if (priority === 'urgent') {
                filteredEmails = emailsData.filter(e => e.priority === 'urgent');
            } else if (priority === 'important') {
                filteredEmails = emailsData.filter(e => e.priority === 'important');
            } else if (priority === 'pending') {
                filteredEmails = emailsData.filter(e => e.unread);
            }
            renderEmailList();
        }

        // ===== æœå°‹åŠŸèƒ½ =====
        function searchEmails(query) {
            if (!query.trim()) {
                filteredEmails = [...emailsData];
            } else {
                const q = query.toLowerCase();
                filteredEmails = emailsData.filter(e =>
                    e.subject.toLowerCase().includes(q) ||
                    e.sender.name.toLowerCase().includes(q) ||
                    e.preview.toLowerCase().includes(q)
                );
            }
            renderEmailList();
        }

        // ===== éƒµä»¶æ“ä½œ =====
        function composeEmail() {
            document.getElementById('composeTo').value = '';
            document.getElementById('composeCc').value = '';
            document.getElementById('composeSubject').value = '';
            document.getElementById('composeBody').value = '';
            document.getElementById('composeModal').classList.add('active');
        }

        function closeCompose() {
            document.getElementById('composeModal').classList.remove('active');
        }

        function sendEmail() {
            alert('éƒµä»¶å·²ç™¼é€ï¼ï¼ˆDemo æ¨¡å¼ï¼‰');
            closeCompose();
        }

        function replyCurrentEmail() {
            if (!selectedEmail) {
                alert('è«‹å…ˆé¸æ“‡ä¸€å°éƒµä»¶');
                return;
            }
            document.getElementById('composeTo').value = selectedEmail.sender.email;
            document.getElementById('composeSubject').value = 'Re: ' + selectedEmail.subject;
            document.getElementById('composeBody').value = `\n\n--- åŸå§‹éƒµä»¶ ---\n${selectedEmail.body}`;
            document.getElementById('composeModal').classList.add('active');
        }

        function replyAllCurrentEmail() {
            replyCurrentEmail();
            document.getElementById('composeCc').value = 'team@example.com';
        }

        function forwardCurrentEmail() {
            if (!selectedEmail) {
                alert('è«‹å…ˆé¸æ“‡ä¸€å°éƒµä»¶');
                return;
            }
            document.getElementById('composeTo').value = '';
            document.getElementById('composeSubject').value = 'Fwd: ' + selectedEmail.subject;
            document.getElementById('composeBody').value = `\n\n--- è½‰ç™¼éƒµä»¶ ---\n${selectedEmail.body}`;
            document.getElementById('composeModal').classList.add('active');
        }

        function deleteCurrentEmail() {
            if (!selectedEmail) {
                alert('è«‹å…ˆé¸æ“‡ä¸€å°éƒµä»¶');
                return;
            }
            if (confirm('ç¢ºå®šè¦åˆªé™¤é€™å°éƒµä»¶å—ï¼Ÿ')) {
                const index = emailsData.findIndex(e => e.id === selectedEmail.id);
                emailsData.splice(index, 1);
                filteredEmails = [...emailsData];
                selectedEmail = null;
                renderEmailList();
                document.getElementById('readingPane').innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ“¬</div>
                        <div class="empty-state-text">é¸æ“‡ä¸€å°éƒµä»¶ä»¥é–±è®€</div>
                    </div>
                `;
                updateCounts();
            }
        }

        function useSuggestedReply() {
            if (selectedEmail) {
                document.getElementById('composeTo').value = selectedEmail.sender.email;
                document.getElementById('composeSubject').value = 'Re: ' + selectedEmail.subject;
                document.getElementById('composeBody').value = selectedEmail.aiInsights.suggestedReply;
                document.getElementById('composeModal').classList.add('active');
            }
        }

        function toggleTodo(element) {
            const checkbox = element.querySelector('input[type="checkbox"]');
            checkbox.checked = !checkbox.checked;
            element.classList.toggle('done');
        }

        // ===== åˆå§‹åŒ– =====
        init();

        console.log('ğŸš€ Outlook AI Pro å·²è¼‰å…¥ï¼');
        console.log('ğŸ“Š å…±è¼‰å…¥ ' + emailsData.length + ' å°éƒµä»¶');
        console.log('âœ¨ æ”¯æ´å®Œæ•´çš„ Outlook åŠŸèƒ½ + AI æ™ºèƒ½åˆ†æ');
    </script>
</body>
</html>
