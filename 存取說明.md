# 📧 Outlook AI 2.0 - 存取說明

## ✅ 當前狀態

- ✅ **伺服器運行中**: Port 3000
- ✅ **前端檔案**: outlook-ai-real.html (1396 行，47KB)
- ✅ **GitHub**: https://github.com/Amberh2616/outlook-ai-2.0
- ⚠️ **Demo 模式**: 10 封測試郵件（尚未連接真實郵箱）
- ⚠️ **AI 基本模式**: 尚未設定 OpenAI API Key

---

## 🚀 四種存取方式

### 方法 1️⃣：本機存取（推薦）

在瀏覽器網址列輸入：
```
http://localhost:3000/outlook-ai-real.html
```

### 方法 2️⃣：IP 位址存取

如果 localhost 無法使用，請使用 IP：
```
http://21.0.0.172:3000/outlook-ai-real.html
```

### 方法 3️⃣：127.0.0.1 存取

另一個本機位址：
```
http://127.0.0.1:3000/outlook-ai-real.html
```

### 方法 4️⃣：快速存取指南頁面

開啟我為您建立的指南頁面（含自動檢測功能）：
```
http://localhost:3000/open-me.html
```

或直接用瀏覽器開啟本機檔案：
```
file:///home/user/web/open-me.html
```

---

## 📂 重要檔案位置

| 檔案 | 路徑 | 說明 |
|------|------|------|
| **主前端** | `/home/user/web/outlook-ai-real.html` | Outlook AI 主介面（無假資料版本）|
| **存取指南** | `/home/user/web/open-me.html` | 快速存取頁面（含狀態檢測）|
| **伺服器測試** | `/home/user/web/test.html` | 簡易連線測試頁面 |
| **後端伺服器** | `/home/user/web/server/server.js` | Node.js 後端服務 |

---

## 🔧 解決「無法存取」問題

### 問題 1：瀏覽器顯示「無法連接」

**解決方案：**
1. 確認伺服器運行中：
   ```bash
   ps aux | grep node
   ```
   應該看到 `node server/server.js` 正在運行

2. 測試伺服器回應：
   ```bash
   curl http://localhost:3000/api/health
   ```
   應該返回：`{"status":"ok",...}`

### 問題 2：localhost 被封鎖

**解決方案：**
- 使用 IP 位址：`http://21.0.0.172:3000/outlook-ai-real.html`
- 或使用：`http://127.0.0.1:3000/outlook-ai-real.html`

### 問題 3：防火牆封鎖 Port 3000

**解決方案：**
1. 檢查 port 是否開啟：
   ```bash
   netstat -tlnp | grep :3000
   ```

2. 如果需要開啟防火牆（根據您的系統）：
   ```bash
   # Ubuntu/Debian
   sudo ufw allow 3000

   # CentOS/RHEL
   sudo firewall-cmd --add-port=3000/tcp --permanent
   sudo firewall-cmd --reload
   ```

### 問題 4：在遠端機器上無法存取

**解決方案：**
- 伺服器已設定監聽 `0.0.0.0`，應該可以從遠端存取
- 使用伺服器 IP：`http://21.0.0.172:3000/outlook-ai-real.html`
- 確認網路可以連接到該 IP 的 3000 port

---

## 🎯 快速測試步驟

### 步驟 1：開啟快速存取頁面

用瀏覽器開啟：
```
file:///home/user/web/open-me.html
```

這個頁面會自動檢測：
- ✅ 伺服器狀態
- ✅ AI 服務狀態
- ✅ 郵件服務狀態

### 步驟 2：點擊「開啟 Outlook AI」按鈕

頁面上有三個按鈕：
- 🚀 **開啟 Outlook AI (localhost)** - 使用 localhost 存取
- 🌐 **開啟 Outlook AI (IP)** - 使用 IP 位址存取
- 🔄 **重新檢測伺服器** - 重新檢查伺服器狀態

### 步驟 3：查看前端介面

成功開啟後，您會看到：
- 左側：寄件人卡片列表（三個狀態區域）
- 右側：郵件內容與 AI 分析面板
- 上方：連線狀態指示器

---

## 🔑 後續設定（當前為 Demo 模式）

### 1. 設定 OpenAI API Key

編輯 `.env` 檔案：
```bash
OPENAI_API_KEY=your_openai_api_key_here
OPENAI_MODEL=gpt-4o
```

重啟伺服器後，AI 功能將啟用。

### 2. 連接真實郵箱

編輯 `.env` 檔案，選擇其中一種：

**選項 A：使用 IMAP/SMTP**
```bash
EMAIL_SERVICE_TYPE=imap
IMAP_HOST=imap.gmail.com
IMAP_PORT=993
IMAP_USER=your.email@gmail.com
IMAP_PASSWORD=your_app_password
```

**選項 B：使用 Microsoft Graph API**
```bash
EMAIL_SERVICE_TYPE=graph
MICROSOFT_CLIENT_ID=your_client_id
MICROSOFT_CLIENT_SECRET=your_client_secret
MICROSOFT_TENANT_ID=your_tenant_id
```

---

## 📊 當前系統資訊

- **伺服器 IP**: 21.0.0.172
- **Port**: 3000
- **運行狀態**: ✅ 正常運行
- **Demo 郵件數量**: 10 封
- **AI 狀態**: 基本模式（模擬回應）
- **GitHub 倉庫**: https://github.com/Amberh2616/outlook-ai-2.0

---

## 💡 建議使用流程

1. **首先**：開啟 `open-me.html` 確認伺服器狀態
2. **然後**：點擊按鈕進入 `outlook-ai-real.html` 主介面
3. **測試**：在 Demo 模式下體驗功能
4. **設定**：確認功能正常後，設定 OpenAI API Key
5. **連接**：最後連接真實郵箱

---

## ⚠️ 注意事項

1. **Demo 模式限制**：
   - 目前顯示 10 封測試郵件
   - AI 分析為模擬回應
   - 無法發送郵件

2. **真實模式需要**：
   - OpenAI API Key（用於 AI 功能）
   - 郵箱帳號密碼（用於讀取真實郵件）

3. **瀏覽器建議**：
   - Chrome、Firefox、Edge 最新版本
   - 啟用 JavaScript
   - 允許連接 localhost

---

## 📞 問題排查

如果以上所有方式都無法存取，請嘗試：

1. **重啟伺服器**：
   ```bash
   # 停止現有伺服器
   pkill -f "node server/server.js"

   # 重新啟動
   cd /home/user/web
   npm start
   ```

2. **查看伺服器日誌**：
   伺服器啟動時應該顯示：
   ```
   ========================================
   🚀 Outlook AI Backend Server Started
   ========================================
   📍 Server: http://localhost:3000
   📍 Server: http://21.0.0.30:3000
   🌐 Environment: development
   📧 Email Service: imap
   🎯 Listening on: 0.0.0.0:3000
   ========================================
   ```

3. **檢查檔案權限**：
   ```bash
   ls -lh /home/user/web/outlook-ai-real.html
   ```
   應該顯示：`-rw-r--r-- 1 root root 47K`

4. **使用 curl 測試**：
   ```bash
   # 測試 API
   curl http://localhost:3000/api/health

   # 測試 HTML
   curl -I http://localhost:3000/outlook-ai-real.html
   ```

---

## ✅ 已完成工作

- ✅ 移除所有假資料（hardcoded mock data）
- ✅ 整合真實 API 端點
- ✅ 實作自動寄件人分組
- ✅ 整合 OpenAI AI 分析功能
- ✅ 三狀態拖拽系統（Pending → Processing → Completed）
- ✅ 推送到 GitHub 倉庫
- ✅ 建立快速存取指南頁面

---

**下一步**：查看前端介面，確認功能符合需求後，再設定 OpenAI API Key 和真實郵箱。
